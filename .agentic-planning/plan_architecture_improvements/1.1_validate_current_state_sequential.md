# 1.1 Валидация текущего состояния (sequential)

**Execution type:** sequential (обязательно выполнить перед изменениями)

---

## Цель

Подтвердить текущее состояние проекта и убедиться, что все системы работают корректно перед началом изменений.

---

## Чек-лист

### 1. Проверка сборки и тестов
```bash
# Очистка кэша
npm run clean

# Сборка всех пакетов
npm run build

# Проверка зависимостей
npm run depcruise

# Запуск тестов
npm run test

# Проверка покрытия
npm run test:coverage

# Полная валидация
npm run validate
```

**Ожидаемый результат:**
- ✅ Все пакеты собираются без ошибок
- ✅ Все тесты проходят
- ✅ Покрытие соответствует порогам (lines ≥90%, branches ≥85%)
- ✅ Нет циклических зависимостей

### 2. Проверка deprecated exports в infrastructure

```bash
# Найти все импорты deprecated config
rg "from '@mcp-framework/infrastructure'" --type ts | grep -E "(ServerConfig|loadConfig)"
```

**Ожидаемый результат:**
- Список всех мест, где используется deprecated config
- Должны быть только в yandex-tracker пакете

### 3. Проверка CacheManager использования

```bash
# Найти все места, где CacheManager используется
rg "CacheManager" --type ts -A 5 -B 5
```

**Ожидаемый результат:**
- Список всех мест использования CacheManager
- Понимание, используется ли async функционал

### 4. Проверка retry конфигурации

```bash
# Найти ExponentialBackoffStrategy
rg "ExponentialBackoffStrategy" --type ts -A 3 -B 3
```

**Ожидаемый результат:**
- Подтверждение hardcoded значений в container.ts

### 5. Проверка Symbol.for в DI

```bash
# Найти все Symbol.for с именами классов
rg "Symbol\.for.*\.name" --type ts
```

**Ожидаемый результат:**
- Список всех генераций символов из имён классов
- Подтверждение отсутствия проверок на коллизии

---

## Документация результатов

После выполнения всех проверок, создать файл:
`.agentic-planning/plan_architecture_improvements/validation_results.md`

С содержимым:
```markdown
# Результаты валидации

## Дата: YYYY-MM-DD

### Сборка и тесты
- [ ] Build: SUCCESS/FAILED
- [ ] Tests: X/Y passed
- [ ] Coverage: X%
- [ ] Depcruise: NO_CYCLES/CYCLES_FOUND

### Deprecated config
Количество импортов: X
Файлы:
- file1.ts:line
- file2.ts:line

### CacheManager
Количество использований: X
Async вызовы: YES/NO

### Retry
Hardcoded в: container.ts:63-84

### DI Symbols
Количество Symbol.for(className): X
Проверок на коллизии: NO
```

---

## Критерий готовности

- ✅ Все проверки выполнены
- ✅ Результаты задокументированы
- ✅ Текущий state проекта корректен (build + tests проходят)
- ✅ Понятен scope изменений для P0/P1 задач
