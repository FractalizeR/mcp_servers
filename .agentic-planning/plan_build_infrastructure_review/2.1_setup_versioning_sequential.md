# 2.1 Настройка автоматического версионирования (Sequential)

**Приоритет:** Высокий
**Тип:** Sequential (требует согласования)
**Статус:** ✅ ЗАВЕРШЁН

---

## Решение

Выбран **Semantic Release** вместо Changesets для полной автоматизации:
- ИИ агент уже пишет коммиты в conventional commits формате
- Версионирование полностью автоматическое на основе коммитов
- CHANGELOG генерируется автоматически

---

## Чеклист

### 1. Установить semantic-release и плагины

- [x] `semantic-release` — основной пакет
- [x] `@semantic-release/changelog` — генерация CHANGELOG
- [x] `@semantic-release/git` — коммит изменений
- [x] `@semantic-release/github` — создание GitHub Release
- [x] `@semantic-release/exec` — запуск скрипта обновления версий
- [x] `conventional-changelog-conventionalcommits` — парсер коммитов
- [x] `@commitlint/cli` + `@commitlint/config-conventional` — валидация коммитов

### 2. Создать конфигурацию

- [x] `.releaserc.json` — конфигурация semantic-release
- [x] `commitlint.config.js` — конфигурация commitlint
- [x] `scripts/update-versions.mjs` — скрипт синхронизации версий во всех пакетах

### 3. Обновить CI workflow

- [x] Обновить `release.yml`:
  - Триггер на push в main (вместо тегов)
  - Job для semantic-release
  - Jobs для npm publish и MCPB (после создания релиза)

### 4. Добавить npm скрипты

- [x] `release` — запуск semantic-release
- [x] `release:dry-run` — тестовый прогон
- [x] `commitlint` — валидация коммитов

### 5. Обновить knip.json

- [x] Добавить semantic-release зависимости в `ignoreDependencies`

---

## Как это работает

```
feat: новая функция     → minor (0.1.0 → 0.2.0)
fix: исправление        → patch (0.1.0 → 0.1.1)
feat!: breaking change  → major (0.1.0 → 1.0.0)
docs:, chore:, test:    → без релиза
```

**Workflow:**
1. ИИ агент делает коммит с conventional commit message
2. Push в main → CI запускает semantic-release
3. Semantic-release анализирует коммиты и определяет версию
4. Все пакеты обновляются до новой версии
5. Создаётся GitHub Release + npm publish

---

## Критерии завершения

- ✅ Semantic-release настроен для monorepo
- ✅ Commitlint валидирует формат коммитов
- ✅ CI автоматически релизит при push в main
- ✅ Все пакеты синхронизируют версии
