# –≠—Ç–∞–ø 2.1: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ü–∏—Ä–∫—É–ª—è—Ä–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π [PARALLEL]

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1 (–≤—ã—Å–æ–∫–∏–π)
**–°—Ç–∞—Ç—É—Å:** ‚è™ –û–∂–∏–¥–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~4-6 —á–∞—Å–æ–≤
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –≠—Ç–∞–ø 1.2 (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ lint)
**–ú–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å:** –≠—Ç–∞–ø 2.2

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–í—Å–µ–≥–æ —Ü–∏—Ä–∫—É–ª—è—Ä–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:** 17
- **–í yandex-tracker:** 15
- **–í framework (search, core):** 2

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ü–∏—Ä–∫—É–ª—è—Ä dependencies

#### –ü–∞—Ç—Ç–µ—Ä–Ω 1: Tool ‚Üî Definition (15 —Å–ª—É—á–∞–µ–≤)
```
ping.definition.ts ‚Üí ping.tool.ts ‚Üí ping.definition.ts
```

#### –ü–∞—Ç—Ç–µ—Ä–Ω 2: Definition ‚Üî Metadata (2 —Å–ª—É—á–∞—è)
```
base-definition.ts ‚Üí tool-metadata.ts ‚Üí base-definition.ts
search-tools.definition.ts ‚Üí search-tools.tool.ts ‚Üí search-tools.definition.ts
```

---

## üîç –≠–¢–ê–ü 1: –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### 1.1. –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ—Ä–Ω–µ–≤–æ–π –ø—Ä–∏—á–∏–Ω—ã

#### –ó–∞–¥–∞—á–∏ –∞–Ω–∞–ª–∏–∑–∞:
- [ ] –ò–∑—É—á–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω Tool/Definition –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- [ ] –ü—Ä–æ—á–∏—Ç–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ definition ‚Üî tool —Ü–∏–∫–ª–æ–≤
- [ ] –ü–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç—å
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–±—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤

#### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:
```bash
# –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ü–∏—Ä–∫—É–ª—è—Ä–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm run depcruise 2>&1 | grep "warn no-circular"

# –ò–∑—É—á–∏—Ç—å –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä –¥–µ—Ç–∞–ª—å–Ω–æ (ping)
cat packages/servers/yandex-tracker/src/tools/ping.definition.ts
cat packages/servers/yandex-tracker/src/tools/ping.tool.ts

# –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏
npm run depcruise:graph
```

#### –¢–∏–ø–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø—Ä–æ–±–ª–µ–º–Ω–∞—è):

**ping.definition.ts:**
```typescript
import { PingTool } from './ping.tool.js';  // ‚Üê Import Tool

export class PingDefinition extends BaseDefinition {
  name = 'yandex_tracker_ping';

  // –°—Å—ã–ª–∫–∞ –Ω–∞ Tool –∫–ª–∞—Å—Å
  ToolClass = PingTool;  // ‚Üê –¶–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç—å!
}
```

**ping.tool.ts:**
```typescript
import { PingDefinition } from './ping.definition.js';  // ‚Üê Import Definition

export class PingTool extends BaseTool {
  constructor(
    definition: PingDefinition,  // ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Definition
    // ...
  ) {}
}
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç—å:**
1. Definition –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç Tool (–¥–ª—è —Å–≤–æ–π—Å—Ç–≤–∞ `ToolClass`)
2. Tool –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç Definition (–¥–ª—è —Ç–∏–ø–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ constructor)
3. –ü–æ–ª—É—á–∞–µ—Ç—Å—è —Ü–∏–∫–ª: Definition ‚Üí Tool ‚Üí Definition

---

### 1.2. –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö 17 —Å–ª—É—á–∞–µ–≤

#### –ì—Ä—É–ø–ø–∞ 1: Yandex Tracker Tools (15 —Å–ª—É—á–∞–µ–≤)

```bash
# –ù–∞–π—Ç–∏ –≤—Å–µ definition/tool –ø–∞—Ä—ã
find packages/servers/yandex-tracker/src/tools -name "*.definition.ts"

# –î–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç–∏
for def in $(find packages/servers/yandex-tracker/src/tools -name "*.definition.ts"); do
  tool="${def/.definition.ts/.tool.ts}"
  if [ -f "$tool" ]; then
    echo "Checking: $def <-> $tool"
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∑–∞–∏–º–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
    grep -l "$(basename $tool .ts)" "$def" && grep -l "$(basename $def .ts)" "$tool" && echo "CIRCULAR!"
  fi
done
```

**–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ —Å —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç—å—é:**
1. `ping.definition.ts` ‚Üî `ping.tool.ts`
2. `update-queue.definition.ts` ‚Üî `update-queue.tool.ts`
3. `manage-queue-access.definition.ts` ‚Üî `manage-queue-access.tool.ts`
4. `get-queues.definition.ts` ‚Üî `get-queues.tool.ts`
5. `get-queue.definition.ts` ‚Üî `get-queue.tool.ts`
6. `get-queue-fields.definition.ts` ‚Üî `get-queue-fields.tool.ts`
7. `create-queue.definition.ts` ‚Üî `create-queue.tool.ts`
8. `get-issue-links.definition.ts` ‚Üî `get-issue-links.tool.ts`
9. `delete-link.definition.ts` ‚Üî `delete-link.tool.ts`
10. `create-link.definition.ts` ‚Üî `create-link.tool.ts`
11. `upload-attachment.definition.ts` ‚Üî `upload-attachment.tool.ts`
12. `get-thumbnail.definition.ts` ‚Üî `get-thumbnail.tool.ts`
13. `get-attachments.definition.ts` ‚Üî `get-attachments.tool.ts`
14. `download-attachment.definition.ts` ‚Üî `download-attachment.tool.ts`
15. `delete-attachment.definition.ts` ‚Üî `delete-attachment.tool.ts`

#### –ì—Ä—É–ø–ø–∞ 2: Framework –ø–∞–∫–µ—Ç—ã (2 —Å–ª—É—á–∞—è)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å core
find packages/framework/core -name "*.definition.ts" -o -name "*metadata.ts"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å search
find packages/framework/search -name "*.definition.ts"
```

**–°–ø–∏—Å–æ–∫:**
1. `packages/framework/core/src/tools/base/base-definition.ts` ‚Üî `tool-metadata.ts`
2. `packages/framework/search/src/tools/search-tools.definition.ts` ‚Üî `search-tools.tool.ts`

---

### 1.3. –ê–Ω–∞–ª–∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π

#### –†–µ—à–µ–Ω–∏–µ 1: –ò–∑–≤–ª–µ—á—å —Ç–∏–ø—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ò–¥–µ—è:**
- –°–æ–∑–¥–∞—Ç—å `*.types.ts` —Å –æ–±—â–∏–º–∏ —Ç–∏–ø–∞–º–∏
- Definition –∏ Tool –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç types, –Ω–æ –Ω–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞
- –£–±—Ä–∞—Ç—å –ø—Ä—è–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã –º–µ–∂–¥—É definition –∏ tool

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
ping.types.ts      ‚Üê –û–±—â–∏–µ —Ç–∏–ø—ã (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, enums)
    ‚Üì
ping.definition.ts ‚Üê –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ types
ping.tool.ts       ‚Üê –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ types
```

**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω—è–µ—Ç —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç—å
- –£–ª—É—á—à–∞–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- –¢–∏–ø—ã –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- –°–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É Dependency Inversion

**–ú–∏–Ω—É—Å—ã:**
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∫–∞–∂–¥–æ–≥–æ tool
- –ù—É–∂–Ω–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å 17 –º–µ—Å—Ç

#### –†–µ—à–µ–Ω–∏–µ 2: Dynamic import –≤ Definition

**–ò–¥–µ—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –¥–ª—è `ToolClass`
- Definition –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç Tool –Ω–∞–ø—Ä—è–º—É—é

**–ü—Ä–∏–º–µ—Ä:**
```typescript
export class PingDefinition extends BaseDefinition {
  name = 'yandex_tracker_ping';

  // –í–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
  async getToolClass() {
    const { PingTool } = await import('./ping.tool.js');
    return PingTool;
  }
}
```

**–ü–ª—é—Å—ã:**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**–ú–∏–Ω—É—Å—ã:**
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å —É—Å–ª–æ–∂–Ω—è–µ—Ç DI
- –ù–µ —Ä–µ—à–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É
- Type safety —Ö—É–∂–µ

#### –†–µ—à–µ–Ω–∏–µ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å type-only imports

**–ò–¥–µ—è:**
- Tool –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç Definition —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ç–∏–ø
- Definition –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç Tool —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ç–∏–ø

**–ü—Ä–∏–º–µ—Ä:**
```typescript
// ping.definition.ts
import type { PingTool } from './ping.tool.js';
export class PingDefinition {
  ToolClass: typeof PingTool;  // ‚ùå –ù–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç - –Ω—É–∂–µ–Ω value
}

// ping.tool.ts
import type { PingDefinition } from './ping.definition.js';
export class PingTool {
  constructor(definition: PingDefinition) {}  // ‚úì OK
}
```

**–ü–ª—é—Å—ã:**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –£–±–∏—Ä–∞–µ—Ç runtime —Ü–∏–∫–ª—ã

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è `ToolClass` (–Ω—É–∂–µ–Ω value, –Ω–µ type)
- –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

#### **–í—ã–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –†–µ—à–µ–Ω–∏–µ 1 (Extract Types)

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ
- –ü–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–±–ª–µ–º—É
- –£–ª—É—á—à–∞–µ—Ç –¥–∏–∑–∞–π–Ω —Å–∏—Å—Ç–µ–º—ã
- –û–¥–∏–Ω —Ä–∞–∑ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–º, –Ω–∞–≤—Å–µ–≥–¥–∞ –∏–∑–±–∞–≤–ª—è–µ–º—Å—è –æ—Ç –ø—Ä–æ–±–ª–µ–º—ã

---

## üõ†Ô∏è –≠–¢–ê–ü 2: –ü–æ—à–∞–≥–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 2.1. –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

#### –®–∞–±–ª–æ–Ω —Ñ–∞–π–ª–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

**–î–û —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**
```
ping.definition.ts
ping.tool.ts
ping.schema.ts
```

**–ü–û–°–õ–ï —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**
```
ping.types.ts       ‚Üê –ù–û–í–´–ô: –û–±—â–∏–µ —Ç–∏–ø—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
ping.definition.ts  ‚Üê –ò–∑–º–µ–Ω–µ–Ω: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç types
ping.tool.ts        ‚Üê –ò–∑–º–µ–Ω–µ–Ω: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç types –∏ definition
ping.schema.ts      ‚Üê –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

#### –°–æ–¥–µ—Ä–∂–∏–º–æ–µ ping.types.ts:
```typescript
/**
 * –û–±—â–∏–µ —Ç–∏–ø—ã –¥–ª—è Ping Tool
 *
 * –í–ê–ñ–ù–û: –≠—Ç–æ—Ç —Ñ–∞–π–ª –ù–ï –¥–æ–ª–∂–µ–Ω –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:
 * - ping.definition.ts
 * - ping.tool.ts
 *
 * –¢–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã.
 */

import type { ToolConstructor } from '@mcp-framework/core';

/**
 * Constructor type –¥–ª—è PingTool
 */
export type PingToolConstructor = ToolConstructor;

/**
 * Params –¥–ª—è ping –æ–ø–µ—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
 */
export interface PingParams {
  // –ü–æ–∫–∞ –ø—É—Å—Ç–æ–π, –Ω–æ –º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ä–∏—Ç—å—Å—è
}

/**
 * Result –¥–ª—è ping –æ–ø–µ—Ä–∞—Ü–∏–∏
 */
export interface PingResult {
  status: 'ok';
  timestamp: string;
}
```

---

### 2.2. –ü–∏–ª–æ—Ç–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (ping tool)

#### –≠—Ç–∞–ø 2.2.1: –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã ping

```bash
# –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã ping
cat packages/servers/yandex-tracker/src/tools/ping.definition.ts
cat packages/servers/yandex-tracker/src/tools/ping.tool.ts
cat packages/servers/yandex-tracker/src/tools/ping.schema.ts

# –ù–∞–π—Ç–∏ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç—ã
grep -E "^import|^export" packages/servers/yandex-tracker/src/tools/ping.*.ts
```

**–ó–∞–¥–∞—á–∏:**
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ —Ç–∏–ø—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –æ–±–æ–∏—Ö —Ñ–∞–π–ª–∞—Ö
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ types
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ circular dependency –≤ schema

#### –≠—Ç–∞–ø 2.2.2: –°–æ–∑–¥–∞–Ω–∏–µ ping.types.ts

```bash
# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª
touch packages/servers/yandex-tracker/src/tools/ping.types.ts
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ (–ø–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è):**
```typescript
/**
 * –¢–∏–ø—ã –¥–ª—è Ping Tool
 * –≠—Ç–æ—Ç —Ñ–∞–π–ª —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç —Ü–∏—Ä–∫—É–ª—è—Ä–Ω—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É definition –∏ tool
 */

// –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã, –µ—Å–ª–∏ –Ω—É–∂–Ω—ã
export interface PingToolConfig {
  // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è tool
}
```

#### –≠—Ç–∞–ø 2.2.3: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ ping.definition.ts

**–î–û:**
```typescript
import { PingTool } from './ping.tool.js';  // ‚Üê –¶–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç—å

export class PingDefinition extends BaseDefinition {
  ToolClass = PingTool;
}
```

**–ü–û–°–õ–ï:**
```typescript
// –£–±–∏—Ä–∞–µ–º –∏–º–ø–æ—Ä—Ç PingTool
// import { PingTool } from './ping.tool.js';  // ‚Üê –£–¥–∞–ª–µ–Ω–æ

import type { ToolConstructor } from '@mcp-framework/core';

export class PingDefinition extends BaseDefinition {
  // –í–º–µ—Å—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º lazy loading
  // –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É —á–µ—Ä–µ–∑ DI

  // –í–∞—Ä–∏–∞–Ω—Ç 1: –£–±—Ä–∞—Ç—å ToolClass (–µ—Å–ª–∏ DI —Å–∞–º –Ω–∞—Ö–æ–¥–∏—Ç)
  // ToolClass —É–¥–∞–ª–µ–Ω

  // –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å getter
  get ToolClass(): ToolConstructor {
    // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –∏–ª–∏ —á–µ—Ä–µ–∑ DI registry
    return this.getRegisteredToolClass();
  }
}
```

**–í–ê–ñ–ù–û:** –ù—É–∂–Ω–æ –∏–∑—É—á–∏—Ç—å, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ToolClass` –≤ DI —Å–∏—Å—Ç–µ–º–µ!

```bash
# –ù–∞–π—Ç–∏, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ToolClass
grep -r "ToolClass" packages/servers/yandex-tracker/src/composition-root/
grep -r "definition.ToolClass" packages/
```

#### –≠—Ç–∞–ø 2.2.4: –ò–∑—É—á–µ–Ω–∏–µ DI –º–µ—Ö–∞–Ω–∏–∑–º–∞

```bash
# –ü—Ä–æ—á–∏—Ç–∞—Ç—å tool-definitions.ts
cat packages/servers/yandex-tracker/src/composition-root/definitions/tool-definitions.ts

# –ù–∞–π—Ç–∏, –∫–∞–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è tools
grep -A 10 "registerTool" packages/servers/yandex-tracker/src/composition-root/
```

**–í–æ–ø—Ä–æ—Å—ã:**
1. –ù—É–∂–µ–Ω –ª–∏ `ToolClass` –≤ Definition?
2. –ú–æ–∂–Ω–æ –ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å Tool –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç Definition?
3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–∏ DI `ToolClass` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤?

#### –≠—Ç–∞–ø 2.2.5: –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è A: Symbol-based registration**
```typescript
// ping.definition.ts
export const PING_TOOL_TOKEN = Symbol('PingTool');

export class PingDefinition {
  toolToken = PING_TOOL_TOKEN;  // –í–º–µ—Å—Ç–æ ToolClass
}

// composition-root
container.bind(PING_TOOL_TOKEN).to(PingTool);
container.bind(PING_DEFINITION_TOKEN).toConstantValue(new PingDefinition());
```

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è B: –£–¥–∞–ª–∏—Ç—å ToolClass –∏–∑ Definition**
```typescript
// –ï—Å–ª–∏ ToolClass –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å
export class PingDefinition {
  // ToolClass —É–¥–∞–ª–µ–Ω, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –¥—Ä—É–≥–æ–π –º–µ—Ö–∞–Ω–∏–∑–º
}
```

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è C: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å string reference**
```typescript
export class PingDefinition {
  toolClassName = 'PingTool';  // String –≤–º–µ—Å—Ç–æ –∫–ª–∞—Å—Å–∞
}
```

**–í—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã DI. –ù—É–∂–Ω–æ –∏–∑—É—á–∏—Ç—å –∫–æ–¥!**

---

### 2.3. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ framework packages

#### –°–ª—É—á–∞–π 1: core/base-definition ‚Üî tool-metadata

```bash
# –ò–∑—É—á–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É
cat packages/framework/core/src/tools/base/base-definition.ts
cat packages/framework/core/src/tools/base/tool-metadata.ts

# –ù–∞–π—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
grep -n "import.*tool-metadata" packages/framework/core/src/tools/base/base-definition.ts
grep -n "import.*base-definition" packages/framework/core/src/tools/base/tool-metadata.ts
```

**–ó–∞–¥–∞—á–∏:**
- [ ] –ü–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É metadata –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç definition
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–±—â–∏–µ —Ç–∏–ø—ã
- [ ] –°–æ–∑–¥–∞—Ç—å `base.types.ts` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –æ–±–∞ —Ñ–∞–π–ª–∞

#### –°–ª—É—á–∞–π 2: search/search-tools —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç—å

```bash
# –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ ping, –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ—Ç –∂–µ –ø–∞—Ç—Ç–µ—Ä–Ω
cat packages/framework/search/src/tools/search-tools.definition.ts
cat packages/framework/search/src/tools/search-tools.tool.ts
```

---

### 2.4. –ú–∞—Å—Å–æ–≤—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ yandex-tracker tools

#### –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:

```bash
# scripts/refactor-circular-deps.sh
#!/bin/bash

# –°–ø–∏—Å–æ–∫ tool names
TOOLS=(
  "ping"
  "update-queue"
  "manage-queue-access"
  # ... –µ—â–µ 12
)

for tool in "${TOOLS[@]}"; do
  echo "Refactoring $tool..."

  # –ù–∞–π—Ç–∏ —Ñ–∞–π–ª—ã
  DEFFILE=$(find packages/servers/yandex-tracker/src/tools -name "${tool}.definition.ts")
  TOOLFILE="${DEFFILE/.definition.ts/.tool.ts}"
  TYPESFILE="${DEFFILE/.definition.ts/.types.ts}"

  # –°–æ–∑–¥–∞—Ç—å types —Ñ–∞–π–ª (–∑–∞–≥–ª—É—à–∫–∞)
  if [ ! -f "$TYPESFILE" ]; then
    cat > "$TYPESFILE" <<EOF
/**
 * Types for $(basename $tool) tool
 */
export interface ${tool^}ToolConfig {}
EOF
  fi

  echo "Created $TYPESFILE"
done
```

#### –†—É—á–Ω–æ–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–∞–∂–¥–æ–≥–æ tool:
- [ ] –î–ª—è –∫–∞–∂–¥–æ–≥–æ tool —Å–æ–∑–¥–∞—Ç—å `.types.ts`
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –æ–±—â–∏–µ —Ç–∏–ø—ã –≤ `.types.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `.definition.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `.tool.ts`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç—å: `npm run depcruise`

---

## ‚úÖ –≠–¢–ê–ü 3: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 3.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–∏—Ä–∫—É–ª—è—Ä–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å
npm run depcruise 2>&1 | grep "no-circular"

# –î–æ–ª–∂–Ω–æ —É–º–µ–Ω—å—à–∞—Ç—å—Å—è:
# –î–æ:  17 —Ü–∏—Ä–∫—É–ª—è—Ä–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
# –ü–æ—Å–ª–µ 1 tool: 16
# –ü–æ—Å–ª–µ 2 tools: 15
# ...
# –ü–æ—Å–ª–µ –≤—Å–µ—Ö: 0
```

### 3.2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ tool

```bash
# –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∫–∞–∂–¥–æ–≥–æ tool
npm run typecheck
npm run build
npm run test

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π tool —Ä–∞–±–æ—Ç–∞–µ—Ç
npm run test -- ${tool_name}
```

### 3.3. Integration —Ç–µ—Å—Ç—ã

```bash
# Smoke test –≤—Å–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
npm run test:smoke --workspace=@mcp-server/yandex-tracker

# –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
npm run validate
```

---

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: DI –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ Tool

**–°–∏–º–ø—Ç–æ–º:**
```
Error: No matching bindings found for serviceIdentifier: PingTool
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –≤ container
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ symbol/token –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ò–∑—É—á–∏—Ç—å tool-definitions.ts

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –¢–∏–ø—ã –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

**–°–∏–º–ø—Ç–æ–º:**
```
Type 'X' is not assignable to type 'Y'
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ —Ç–∏–ø—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ .types.ts
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏–º–ø–æ—Ä—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `import type` –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–æ–≤—ã–µ —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

**–°–∏–º–ø—Ç–æ–º:**
```
warn no-circular: new-file.ts ‚Üí types.ts ‚Üí new-file.ts
```

**–†–µ—à–µ–Ω–∏–µ:**
- types.ts –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∏—á–µ–≥–æ, –∫—Ä–æ–º–µ –±–∞–∑–æ–≤—ã—Ö —Ç–∏–ø–æ–≤
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### –¢—Ä–µ–∫–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:

```markdown
## Yandex Tracker Tools (15/15)
- [ ] ping
- [ ] update-queue
- [ ] manage-queue-access
- [ ] get-queues
- [ ] get-queue
- [ ] get-queue-fields
- [ ] create-queue
- [ ] get-issue-links
- [ ] delete-link
- [ ] create-link
- [ ] upload-attachment
- [ ] get-thumbnail
- [ ] get-attachments
- [ ] download-attachment
- [ ] delete-attachment

## Framework (2/2)
- [ ] core: base-definition ‚Üî tool-metadata
- [ ] search: search-tools

## –¶–∏—Ä–∫—É–ª—è—Ä–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ë—ã–ª–æ: 17
- –û—Å—Ç–∞–ª–æ—Å—å: __
- –¶–µ–ª—å: 0
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

- [ ] –í—Å–µ 17 —Ü–∏—Ä–∫—É–ª—è—Ä–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- [ ] `npm run depcruise` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 0 warnings "no-circular"
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (97/97)
- [ ] TypeCheck —É—Å–ø–µ—à–µ–Ω
- [ ] Build —É—Å–ø–µ—à–µ–Ω
- [ ] Smoke test —É—Å–ø–µ—à–µ–Ω
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–±–Ω–æ–≤–∏—Ç—å ARCHITECTURE.md:

```markdown
### Tool/Definition –ø–∞—Ç—Ç–µ—Ä–Ω

–î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Ü–∏—Ä–∫—É–ª—è—Ä–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

\`\`\`
tool-name.types.ts      ‚Üê –û–±—â–∏–µ —Ç–∏–ø—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
tool-name.definition.ts ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç types
tool-name.tool.ts       ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç types –∏ definition
tool-name.schema.ts     ‚Üê Zod —Å—Ö–µ–º—ã
\`\`\`

**–ü—Ä–∞–≤–∏–ª–∞:**
- `.types.ts` –ù–ï –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `.definition.ts` –∏–ª–∏ `.tool.ts`
- `.definition.ts` –º–æ–∂–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `.types.ts`
- `.tool.ts` –º–æ–∂–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `.types.ts` –∏ `.definition.ts`
```

### –û–±–Ω–æ–≤–∏—Ç—å tools/README.md:

```markdown
## –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ Tool

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ MCP tool —Å–ª–µ–¥—É–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

1. –°–æ–∑–¥–∞–π `tool-name.types.ts` —Å –æ–±—â–∏–º–∏ —Ç–∏–ø–∞–º–∏
2. –°–æ–∑–¥–∞–π `tool-name.definition.ts`
3. –°–æ–∑–¥–∞–π `tool-name.tool.ts`
4. –°–æ–∑–¥–∞–π `tool-name.schema.ts`

**–í–ê–ñ–ù–û:** –ò–∑–±–µ–≥–∞–π –∏–º–ø–æ—Ä—Ç–∞ tool –≤ definition!
```

---

## ‚è≠Ô∏è –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

–≠—Ç–æ—Ç —ç—Ç–∞–ø –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å:
- **2.2_configure_knip_parallel.md**

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±–æ–∏—Ö:
- –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é
- –°–æ–∑–¥–∞—Ç—å commit
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Å–æ–∑–¥–∞—Ç—å PR
