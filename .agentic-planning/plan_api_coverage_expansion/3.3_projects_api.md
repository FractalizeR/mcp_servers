# Этап 3.3: Projects API (Проекты)

**Статус:** ⏪ Не начат
**Приоритет:** Важный
**Время:** 5-7 дней
**Зависимости:** `1.1_preparation.md`, `2.3_queues_api.md` ⚠️
**Параллельность:** ⚠️ Частичная (после Queues API)

## Цель
Реализовать работу с проектами - создание, получение, обновление, удаление, управление связями с очередями.

## API Endpoints

| Метод | Endpoint | Описание |
|-------|----------|----------|
| GET | `/v3/projects` | Получить список проектов |
| GET | `/v3/projects/{projectId}` | Получить параметры проекта |
| POST | `/v3/projects` | Создать проект |
| PATCH | `/v3/projects/{projectId}` | Обновить проект |
| DELETE | `/v3/projects/{projectId}` | Удалить проект |

## MCP Tools (5)

1. `yandex_tracker_get_projects`
2. `yandex_tracker_get_project`
3. `yandex_tracker_create_project`
4. `yandex_tracker_update_project`
5. `yandex_tracker_delete_project`

---

## Зависимости

⚠️ **Требует Queues API:**
- Проекты связаны с очередями
- Нужен `Queue` entity для типизации
- CreateProjectInput использует queueId

**Можно начать после завершения `2.3_queues_api.md`**

---

## Структура реализации

### 1. Entities
- [ ] `project.entity.ts`
  ```typescript
  export interface Project extends WithUnknownFields {
    id: string;
    self: string;
    version: number;
    key: string;
    name: string;
    description?: string;
    lead: UserRef;
    status: 'draft' | 'in_progress' | 'launched' | 'postponed' | 'at_risk';
    startDate?: string;
    endDate?: string;
    queues?: Array<{
      id: string;
      key: string;
      display: string;
    }>;
    clients?: UserRef[];
    teamUsers?: UserRef[];
  }

  export type ProjectStatus = 'draft' | 'in_progress' | 'launched' | 'postponed' | 'at_risk';
  ```

### 2. DTO
- [ ] `create-project.input.ts`
  ```typescript
  export interface CreateProjectInput {
    name: string;
    queueIds: string[];    // Массив ключей очередей
    description?: string;
    lead?: string;         // ID пользователя
    status?: ProjectStatus;
    startDate?: string;
    endDate?: string;
  }
  ```
- [ ] `update-project.input.ts` - Partial
- [ ] `get-projects.input.ts` - с фильтрами и пагинацией
- [ ] Output DTO

### 3. Operations (5)
- [ ] GetProjectsOperation (с пагинацией)
- [ ] GetProjectOperation
- [ ] CreateProjectOperation
- [ ] UpdateProjectOperation
- [ ] DeleteProjectOperation
- [ ] Unit-тесты

### 4. Tools (5)
- [ ] get-projects tool + tests
- [ ] get-project tool + tests
- [ ] create-project tool + tests
- [ ] update-project tool + tests
- [ ] delete-project tool + tests

### 5. Infrastructure
- [ ] DI registration
- [ ] Fixtures
- [ ] Документация (связь с очередями, статусы)

### 6. Validation & Tests
- [ ] Unit tests ≥90%
- [ ] Integration tests
- [ ] Тесты связей с очередями
- [ ] `npm run validate`

### 7. Commit
- [ ] `feat: добавить поддержку Projects API`
- [ ] Push + update overview

---

## Примеры

```json
// Создать проект
{
  "name": "yandex_tracker_create_project",
  "arguments": {
    "name": "Mobile App Redesign",
    "queueIds": ["MOBILE", "DESIGN"],
    "description": "Q1 2025 redesign project",
    "lead": "john.doe",
    "status": "in_progress",
    "startDate": "2025-01-15",
    "endDate": "2025-03-31"
  }
}

// Получить проекты
{
  "name": "yandex_tracker_get_projects",
  "arguments": {
    "perPage": 50
  }
}
```

---

**Создано:** 2025-01-18
