# –ü–ª–∞–Ω: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –±–∞–≥–æ–≤ Schema-Definition Mismatch
## –ü–æ–¥—Ö–æ–¥: Refactoring-First

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-20
**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2025-11-20 (–ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ refactoring-first)
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π

---

## üéØ –¶–µ–ª—å –ø–ª–∞–Ω–∞

–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –±–∞–≥–∏ schema-definition mismatch —á–µ—Ä–µ–∑ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é MCP definition –∏–∑ Zod schema**, —á—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∏—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è.

**–ù–∞–π–¥–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- 4 –∏–∑ 33 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (12%) –∏–º–µ–ª–∏ –±–∞–≥ schema-definition mismatch
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –Ω–µ –≤—ã—è–≤–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É
- –ë–∞–≥ –¥–µ–ª–∞–ª –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —á–µ—Ä–µ–∑ MCP –ø—Ä–æ—Ç–æ–∫–æ–ª

**–†–µ—à–µ–Ω–∏–µ: Refactoring-First –ø–æ–¥—Ö–æ–¥**
- Zod schema = –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
- MCP definition –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ schema
- –§–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–∞–Ω–∞ (Refactoring-First)

### –≠—Ç–∞–ø 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (Sequential, ~30 –º–∏–Ω)
- `0.1_analyze_current_state_sequential.md` ‚Äî –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –≠—Ç–∞–ø 1: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (Sequential, 4-8 —á–∞—Å–æ–≤)
- `3.1_architectural_refactoring_sequential.md` ‚Äî –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ definition
  - –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ definition –∏–∑ schema
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ BaseTool –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  - –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### –≠—Ç–∞–ø 2: –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (Parallel, 2-3 —á–∞—Å–∞)
–í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- `2.1_adapt_validation_tests_parallel.md` ‚Äî –¢–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
- `2.2_adapt_tool_templates_parallel.md` ‚Äî –®–∞–±–ª–æ–Ω—ã –¥–ª—è –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- `2.3_update_documentation_parallel.md` ‚Äî –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (Sequential, ~1 —á–∞—Å)
- `3.1_integrate_and_validate_sequential.md` ‚Äî –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

---

## ‚è±Ô∏è –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –¢–∏–ø |
|------|-------|-----|
| 0. –ê–Ω–∞–ª–∏–∑ | 0.5 —á–∞—Å–∞ | Sequential |
| 1. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ | 4-8 —á–∞—Å–æ–≤ | Sequential |
| 2.1 –¢–µ—Å—Ç—ã | 1-1.5 —á–∞—Å–∞ | Parallel |
| 2.2 –®–∞–±–ª–æ–Ω—ã | 0.5-1 —á–∞—Å | Parallel |
| 2.3 –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 0.5-1 —á–∞—Å | Parallel |
| 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | 1 —á–∞—Å | Sequential |
| **–ò—Ç–æ–≥–æ:** | **6.5-12 —á–∞—Å–æ–≤** | |

**–ü—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —ç—Ç–∞–ø–∞ 2 (3 –∞–≥–µ–Ω—Ç–∞):** ~6.5-10.5 —á–∞—Å–æ–≤

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä definition –∏–∑ schema
- [ ] –í—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é
- [ ] –§–∞–π–ª—ã `*.definition.ts` —É–¥–∞–ª–µ–Ω—ã (–Ω–µ –Ω—É–∂–Ω—ã)
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ä–∞–±–æ—Ç—É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
- [ ] –®–∞–±–ª–æ–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ü–ª–∞–Ω —É–¥–∞–ª–µ–Ω –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## üìù –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### Refactoring-First –ø–æ–¥—Ö–æ–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

1. **–û–¥–∏–Ω –∞–≥–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —ç—Ç–∞–ø 0**
   - –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
   - –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞

2. **–û–¥–∏–Ω –∞–≥–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —ç—Ç–∞–ø 1** (–∫—Ä–∏—Ç–∏—á–Ω—ã–π!)
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
   - –ú–∏–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
   - –≠—Ç–æ —Å–∞–º—ã–π –¥–æ–ª–≥–∏–π —ç—Ç–∞–ø (4-8 —á–∞—Å–æ–≤)

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å 3 –∞–≥–µ–Ω—Ç–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –¥–ª—è —ç—Ç–∞–ø–∞ 2:**
   - –ê–≥–µ–Ω—Ç A: 2.1 (—Ç–µ—Å—Ç—ã)
   - –ê–≥–µ–Ω—Ç B: 2.2 (—à–∞–±–ª–æ–Ω—ã)
   - –ê–≥–µ–Ω—Ç C: 2.3 (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

4. **–û–¥–∏–Ω –∞–≥–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —ç—Ç–∞–ø 3**
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ refactoring-first:
- ‚úÖ –§–∏–∑–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±–∞–≥–∞
- ‚úÖ –£–ø—Ä–æ—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ DRY –ø—Ä–∏–Ω—Ü–∏–ø (–æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è schema ‚Üî definition

### –†–∏—Å–∫–∏:
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- ‚ùå –ú–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚ùå –¢—Ä–µ–±—É–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚ùå –î–æ–ª–≥–∏–π –ø—Ä–æ—Ü–µ—Å—Å (4-8 —á–∞—Å–æ–≤ –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)

### –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Ä–∏—Å–∫–æ–≤:
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è (–ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ fallback –Ω–∞ —Ä—É—á–Ω–æ–π definition –¥–ª—è edge cases
- Thorough —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ —á–µ—Ä–µ–∑ git

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- –ë–∞–≥-—Ä–µ–ø–æ—Ä—Ç: [–ö–æ–º–º–∏—Ç de41f2c](../../../packages/servers/yandex-tracker/)
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [CLAUDE.md](../../CLAUDE.md)
- –¢–µ—Å—Ç—ã: `packages/servers/yandex-tracker/tests/tools/`

---

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–≠—Ç–æ **refactoring-first** –≤–µ—Ä—Å–∏—è –ø–ª–∞–Ω–∞. –ï—Å–ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã—è—Å–Ω–∏—Ç—Å—è, —á—Ç–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–ª–∏—à–∫–æ–º —Ä–∏—Å–∫–æ–≤–∞–Ω –∏–ª–∏ —Å–ª–æ–∂–µ–Ω, –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –ø–ª–∞–Ω—É —Å —ç—Ç–∞–ø–∞–º–∏ 1.1-1.4 (–±—ã—Å—Ç—Ä–∞—è –∑–∞—â–∏—Ç–∞).
