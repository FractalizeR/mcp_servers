# 2.1 Устранение циклических зависимостей в CLI

**Тип:** Parallel (можно выполнять параллельно с 2.2-2.4)
**Пакет:** `@mcp-framework/cli`
**Оценка:** 30-45 минут
**Статус:** [ ] Не начато

## Проблема

Циклические зависимости:
```
src/types.ts → src/utils/config-manager.ts → src/types.ts
src/connectors/base/connector.interface.ts → src/types.ts → src/connectors/base/connector.interface.ts
```

## Анализ (выполнить первым)

- [ ] Изучить `src/types.ts` — какие типы экспортируются
- [ ] Изучить `src/utils/config-manager.ts` — какие типы импортируются из types.ts
- [ ] Изучить `src/connectors/base/connector.interface.ts` — зависимости
- [ ] Построить карту зависимостей: какой тип куда импортируется

## Стратегия решения

### Вариант A: Выделение базовых типов
1. Создать `src/types/base.types.ts` — типы без зависимостей
2. Создать `src/types/config.types.ts` — типы для конфигурации
3. Создать `src/types/connector.types.ts` — типы для коннекторов
4. Оставить `src/types.ts` как re-export barrel

### Вариант B: Инверсия зависимости
1. Определить, какой модуль должен быть "владельцем" типов
2. Перенести типы туда, откуда они логически происходят
3. Другие модули импортируют из владельца

## Шаги реализации

- [ ] Выбрать стратегию (A или B) после анализа
- [ ] Создать новую структуру файлов типов
- [ ] Обновить импорты во всех затронутых файлах
- [ ] Проверить: `npm run depcruise -w cli`
- [ ] Убедиться что циклов нет

## Валидация

```bash
cd packages/framework/cli
npm run depcruise
npm run lint
npm run typecheck
npm run test
```

- [ ] `depcruise` показывает 0 violations
- [ ] Все тесты проходят

## Коммит

```
fix(cli): resolve circular dependencies in types

- Extract base types to separate file
- Reorganize type imports to break cycles
- Validate with dependency-cruiser
```

## Чек-лист завершения

- [ ] Циклические зависимости устранены
- [ ] Все тесты проходят
- [ ] Изменения закоммичены
