# –≠—Ç–∞–ø 2.2: –ú–∏–≥—Ä–∞—Ü–∏—è Queues –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (Parallel)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** Medium
**–¢–∏–ø –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** Parallel
**–í—Ä–µ–º—è:** ~30 –º–∏–Ω—É—Ç
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:** 6 tools
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è

---

## üéØ –¶–µ–ª—å

–ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 6 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ Queues –Ω–∞ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é MCP definition.

**–í–∞–∂–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±—ã–ª–∏ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã –≤ original bug (4 –∏–∑ –Ω–∏—Ö –∏–º–µ–ª–∏ schema-definition mismatch). –¢—Ä–µ–±—É–µ—Ç—Å—è –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ definition.

---

## üìã –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏

1. **create-queue** - `queues/create-queue.tool.ts`
2. **update-queue** - `queues/update-queue.tool.ts`
3. **get-queue** - `queues/get-queue.tool.ts`
4. **get-queues** - `queues/get-queues.tool.ts`
5. **get-queue-fields** - `queues/get-queue-fields.tool.ts`
6. **manage-queue-access** - `queues/manage-queue-access.tool.ts`

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Å–ª–æ–∂–Ω—ã–µ schemas —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏.

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞:

- [x] **create-queue**
  - [x] –û—Ç–∫—Ä—ã—Ç—å `queues/create-queue.tool.ts`
  - [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getParamsSchema()` –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é schema
  - [x] –ü–æ–º–µ—Ç–∏—Ç—å `buildDefinition()` –∫–∞–∫ `@deprecated`
  - [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `npm test -- create-queue`
  - [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ definition –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

- [x] **update-queue**
  - [x] –û—Ç–∫—Ä—ã—Ç—å `queues/update-queue.tool.ts`
  - [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getParamsSchema()` –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é schema
  - [x] –ü–æ–º–µ—Ç–∏—Ç—å `buildDefinition()` –∫–∞–∫ `@deprecated`
  - [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `npm test -- update-queue`
  - [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ definition –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

- [x] **get-queue**
  - [x] –û—Ç–∫—Ä—ã—Ç—å `queues/get-queue.tool.ts`
  - [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getParamsSchema()` –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é schema
  - [x] –ü–æ–º–µ—Ç–∏—Ç—å `buildDefinition()` –∫–∞–∫ `@deprecated`
  - [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `npm test -- get-queue`
  - [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ definition –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

- [x] **get-queues**
  - [x] –û—Ç–∫—Ä—ã—Ç—å `queues/get-queues.tool.ts`
  - [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getParamsSchema()` –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é schema
  - [x] –ü–æ–º–µ—Ç–∏—Ç—å `buildDefinition()` –∫–∞–∫ `@deprecated`
  - [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `npm test -- get-queues`
  - [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ definition –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

- [x] **get-queue-fields**
  - [x] –û—Ç–∫—Ä—ã—Ç—å `queues/get-queue-fields.tool.ts`
  - [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getParamsSchema()` –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é schema
  - [x] –ü–æ–º–µ—Ç–∏—Ç—å `buildDefinition()` –∫–∞–∫ `@deprecated`
  - [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `npm test -- get-queue-fields`
  - [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ definition –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

- [x] **manage-queue-access**
  - [x] –û—Ç–∫—Ä—ã—Ç—å `queues/manage-queue-access.tool.ts`
  - [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getParamsSchema()` –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é schema
  - [x] –ü–æ–º–µ—Ç–∏—Ç—å `buildDefinition()` –∫–∞–∫ `@deprecated`
  - [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `npm test -- manage-queue-access`
  - [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ definition –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è:

- [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã queues: `npm test -- queues`
- [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é: `npm run validate:quiet`
- [x] –°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç:
  ```bash
  git commit -m "feat(migration): migrate queues tools to autogeneration (6/47)"
  ```
- [x] –ü—É—à –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [x] –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤ –ø–ª–∞–Ω–µ

---

## üìù –®–∞–±–ª–æ–Ω –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –û–±—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –≤—Å–µ—Ö queues tools:

#### –ë–´–õ–û (old approach):

```typescript
export class SomeQueueTool extends BaseTool<YandexTrackerFacade> {
  static override readonly METADATA = SOME_QUEUE_TOOL_METADATA;

  private readonly definition = new SomeQueueDefinition();

  protected buildDefinition(): ToolDefinition {
    return this.definition.build();
  }

  async execute(params: ToolCallParams): Promise<ToolResult> {
    const validation = this.validateParams(params, SomeQueueParamsSchema);
    // ...
  }
}
```

#### –°–¢–ê–õ–û (new approach):

```typescript
export class SomeQueueTool extends BaseTool<YandexTrackerFacade> {
  static override readonly METADATA = SOME_QUEUE_TOOL_METADATA;

  /**
   * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è definition –∏–∑ Zod schema
   * –≠—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è schema ‚Üî definition
   */
  protected override getParamsSchema(): typeof SomeQueueParamsSchema {
    return SomeQueueParamsSchema;
  }

  /**
   * @deprecated –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ getParamsSchema()
   */
  protected buildDefinition(): ToolDefinition {
    // Fallback –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ—Å–ª–∏ getParamsSchema() –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)
    const definition = new SomeQueueDefinition();
    return definition.build();
  }

  async execute(params: ToolCallParams): Promise<ToolResult> {
    const validation = this.validateParams(params, SomeQueueParamsSchema);
    // ...
  }
}
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏

### –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
npm test -- create-queue.test.ts

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ definition –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
npm test -- create-queue.smoke.test.ts  # –µ—Å–ª–∏ –µ—Å—Ç—å
```

### –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö queues:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
npm test -- queues

# –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
npm run validate:quiet
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏

**–î–æ –º–∏–≥—Ä–∞—Ü–∏–∏ —ç—Ç–∞–ø–∞ 2.2:**
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π: 19/49 (38.8%)
- –§–∞–π–ª–æ–≤ `.definition.ts`: 49

**–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —ç—Ç–∞–ø–∞ 2.2:**
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π: 25/49 (51%)
- –§–∞–π–ª–æ–≤ `.definition.ts`: 49 (–µ—â–µ –Ω–µ —É–¥–∞–ª–µ–Ω—ã)

---

## üîó –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫:
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å —ç—Ç–∏–º:** —ç—Ç–∞–ø 2.1 (Issues) - 9 tools, —ç—Ç–∞–ø 2.3 (Projects) - 5 tools
- **–ü–æ—Å–ª–µ –≤—Å–µ–≥–æ —ç—Ç–∞–ø–∞ 2:** —ç—Ç–∞–ø 3.1 (Bulk-change) - 4 tools

---

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –°–ª–æ–∂–Ω—ã–µ nested schemas

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** `create-queue` –∏ `update-queue` –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Å–ª–æ–∂–Ω—ã–µ schemas —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ—á–µ—Ä–µ–¥–∏
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `generateDefinitionFromSchema` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç nested objects

### 2. –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

**–ü—Ä–∏—á–∏–Ω–∞:** –í–æ–∑–º–æ–∂–Ω–æ, schema –∏–º–µ–µ—Ç –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–∏–ø—ã
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ `generateDefinitionFromSchema` –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Zod —Ç–∏–ø—ã

### 3. Definition –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–æ–∂–Ω–∞—è schema —Å union/intersection types
**–†–µ—à–µ–Ω–∏–µ:** –û—Å—Ç–∞–≤–∏—Ç—å —Ä—É—á–Ω–æ–π `buildDefinition()` –¥–ª—è —ç—Ç–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞, —Å–æ–∑–¥–∞—Ç—å issue –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞

### 4. Schema-definition mismatch bugs

**–í–∞–∂–Ω–æ:** 4 –∏–∑ 6 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ queues –±—ã–ª–∏ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã –≤ original bug
**–î–µ–π—Å—Ç–≤–∏–µ:** –û—Å–æ–±–µ–Ω–Ω–æ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ definition –¥–ª—è:
- `create-queue`
- `update-queue`
- `get-queue-fields`
- `manage-queue-access`

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

- [ ] –í—Å–µ 6 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –ú–µ—Ç–æ–¥ `getParamsSchema()` –¥–æ–±–∞–≤–ª–µ–Ω –≤–æ –≤—Å–µ tools
- [ ] –ú–µ—Ç–æ–¥ `buildDefinition()` –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ `@deprecated`
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] `npm run validate:quiet` –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ö–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–ø—É—à–µ–Ω
- [ ] –°—Ç–∞—Ç—É—Å –ø–ª–∞–Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~30 –º–∏–Ω—É—Ç
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 6 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã (25/49 total = 51%)
