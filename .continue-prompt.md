# Промт для продолжения работы над fractalizer_mcp_yandex_tracker

## Контекст проекта

Это **fractalizer_mcp_yandex_tracker** (FractalizeR's Yandex Tracker MCP) — MCP сервер для интеграции с API Яндекс.Трекера v3.

### Что уже сделано (последние изменения)

1. **Ребрендинг проекта:**
   - `yandex-tracker-mcp` → `fractalizer_mcp_yandex_tracker`
   - Все инструменты переименованы: `yandex_tracker_*` → `fractalizer_mcp_yandex_tracker_*`
   - Создан файл констант: `src/constants.ts`

2. **CLI инструмент для управления подключениями:**
   - Полностью реализован интерактивный CLI
   - 3 коннектора: Claude Desktop, Claude Code, Codex
   - 4 команды: connect, disconnect, status, list
   - Расширяемая архитектура (легко добавлять новые клиенты)
   - Документация: `src/cli/README.md`

3. **Текущее состояние:**
   - ✅ CLI работает (протестирован вручную)
   - ✅ Сборка успешна (`npm run build`)
   - ✅ Lint: 0 errors, 21 warnings (только стилистические)
   - ⚠️ Unit тесты для CLI не написаны
   - ⚠️ Интеграционные тесты CLI отсутствуют

### Последние коммиты

```
444d3e2 docs: добавить руководство пользователя для CLI
2e59780 feat: ребрендинг проекта в fractalizer_mcp_yandex_tracker + CLI инструмент для управления подключениями
```

---

## Возможные направления работы

### 1. Тестирование CLI (приоритет: высокий)

**Что нужно:**
- Unit тесты для коннекторов (`tests/cli/connectors/`)
- Mock'и для файловых операций и `child_process`
- Тесты для команд (`tests/cli/commands/`)
- Интеграционные тесты (реальное создание конфигов)

**Чек-лист:**
- [ ] Тесты для `ClaudeDesktopConnector` (чтение/запись JSON)
- [ ] Тесты для `ClaudeCodeConnector` (вызов CLI команд)
- [ ] Тесты для `CodexConnector` (TOML операции)
- [ ] Тесты для `ConnectorRegistry` (поиск установленных)
- [ ] Тесты для команд (connect, disconnect, status, list)
- [ ] Mock для `inquirer` (интерактивные вопросы)

**Инструменты:** Vitest, mock'и для fs/promises, child_process

---

### 2. Улучшения CLI (приоритет: средний)

**Идеи:**
- Добавить флаг `--dry-run` для предпросмотра изменений
- Команда `validate` — проверка корректности существующих конфигов
- Команда `migrate` — миграция со старого формата на новый
- Поддержка `.env` файла для хранения токена (локально)
- Цветной diff при изменении конфигов
- Поддержка множественного подключения (к нескольким клиентам сразу)

**Примеры:**
```bash
npm run mcp:connect -- --dry-run           # Показать что будет изменено
npm run mcp:validate                       # Проверить конфиги
npm run mcp:connect -- --all               # Подключить ко всем
```

---

### 3. Новые коннекторы (приоритет: низкий)

**Возможные клиенты:**
- **Cursor** — если поддерживает MCP
- **Zed** — если поддерживает MCP
- **VS Code extensions** — если появятся

**Для добавления:**
1. Создать класс в `cli/connectors/new-client/`
2. Реализовать `MCPConnector`
3. Зарегистрировать в `ConnectorRegistry` (1 строка)

---

### 4. Документация (приоритет: средний)

**Что можно улучшить:**
- Добавить примеры использования в README.md
- Создать CHANGELOG.md
- Добавить скриншоты CLI в действии
- Написать CONTRIBUTING.md (если планируется open source)
- Создать FAQ.md с частыми вопросами

---

### 5. Подготовка к публикации (приоритет: низкий)

**Если планируешь опубликовать в npm:**
- [ ] Проверить `package.json` (name, version, keywords)
- [ ] Добавить `bin` для глобальной установки
- [ ] Создать `.npmignore` (исключить тесты, docs)
- [ ] Протестировать установку: `npm pack` → `npm install -g fractalizer_mcp_yandex_tracker-*.tgz`
- [ ] Опубликовать: `npm publish --access public`

**Scoped package:**
```json
{
  "name": "@fractalizer/fractalizer_mcp_yandex_tracker",
  "bin": {
    "fractalizer_mcp_yandex_tracker": "./dist/cli/bin/mcp-connect.js"
  }
}
```

---

## Команды для начала работы

```bash
# Проверить статус
git status

# Просмотреть последние изменения
git log --oneline -5

# Запустить CLI
npm run mcp:list
npm run mcp:status

# Запустить тесты (когда будут написаны)
npm run test:unit

# Полная валидация
npm run validate
```

---

## Важные файлы для изучения

**Если нужно разобраться в CLI:**
- `cli/connectors/base/connector.interface.ts` — базовый интерфейс
- `cli/connectors/registry.ts` — реестр коннекторов
- `cli/commands/connect.command.ts` — главная команда
- `src/cli/README.md` — полная архитектура

**Если нужно добавить новый инструмент:**
- `src/mcp/CONVENTIONS.md` — правила для MCP tools
- `src/composition-root/definitions/tool-definitions.ts` — регистрация

**Если нужно исправить warnings:**
```bash
npm run lint 2>&1 | grep "warning"
```

---

## Следующие шаги (рекомендация)

1. **Написать тесты для CLI** — критично для надежности
2. **Протестировать реальное подключение** — подключиться к Claude Desktop/Code
3. **Исправить ESLint warnings** — улучшить качество кода
4. **Обновить ARCHITECTURE.md** — добавить информацию о CLI

---

## Если возникли проблемы

**CLI не работает:**
- Проверь сборку: `npm run build`
- Проверь зависимости: `npm install`

**Тесты падают:**
- Запусти только CLI тесты: `npm run test -- cli/`
- Проверь mock'и для файловых операций

**Git конфликты:**
- Последние изменения в коммите `444d3e2`
- Все изменения в `cli/` директории и `src/constants.ts`

---

## Дополнительная информация

- **Проект:** https://github.com/fractalizer/fractalizer_mcp_yandex_tracker
- **Документация:** `README.md`, `src/cli/README.md`, `ARCHITECTURE.md`
- **Конвенции:** `CLAUDE.md`, module README files
